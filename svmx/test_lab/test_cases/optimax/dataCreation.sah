var $user_credentials_xls = $excel.readFromCustomExcel("../optimax/op_excleData/automation.xlsx", "User_Details","","");
var $businessHour_xls = $excel.readFromCustomExcel("../optimax/op_excleData/automation.xlsx", "BusinessHours","","");
var $work_Orders_Xl = $excel.readFromCustomExcel("../optimax/op_excleData/automation.xlsx", "RS_6665","","");

for(var $i=0;$i<$user_credentials_xls.length;$i++)
{
	var $g_un = $user_credentials_xls[$i][0];
	var $g_pwd = $user_credentials_xls[$i][1];
	var $g_url = $user_credentials_xls[$i][2];
}

$bo_act_login.login($g_url, $g_un, $g_pwd);

_set($login_result, _fetch(login($g_un,$g_pwd)));
_log($login_result);

_set($BH_creation, _fetch(createBH($work_Orders_Xl)));
_log($BH_creation);

//<browser>

function login($g_un,$g_pwd)
{
	var $login_result = sforce.connection.login($g_un,$g_pwd);
	return $login_result;
}

function createBH($businessHour_xls)
{
	createBh = [];
	/*var $isSuccess = false;
	for(var $i=0;$i<$businessHour_xls.length;$i++){
		var bh = new sforce.SObject("BusinessHours");
		bh.Name = $businessHour_xls[$i][0];
		bh.IsActive = $businessHour_xls[$i][1];
		bh.TimeZoneSidKey = $businessHour_xls[$i][2];
		bh.MondayStartTime = $businessHour_xls[$i][3];
		bh.MondayEndTime = $businessHour_xls[$i][4];
		bh.TuesdayStartTime = $businessHour_xls[$i][5];
		bh.TuesdayEndTime = $businessHour_xls[$i][6];
		bh.WednesdayStartTime  = $businessHour_xls[$i][7];
		bh.WednesdayEndTime = $businessHour_xls[$i][8];
		bh.ThursdayStartTime = $businessHour_xls[$i][9];
		bh.ThursdayEndTime = $businessHour_xls[$i][10];
		bh.FridayStartTime = $businessHour_xls[$i][11];
		bh.FridayEndTime = $businessHour_xls[$i][12];
		bh.SaturdayStartTime = $businessHour_xls[$i][13];
		bh.SaturdayEndTime = $businessHour_xls[$i][14];
		bh.SundayStartTime = $businessHour_xls[$i][15];
		bh.SundayEndTime = $businessHour_xls[$i][16];
		createBh.push(bh);
	}
	var bh_result = _call(sforce.connection.create(createBh));
	_log("bh_result id = "+bh_result);*/
	
	for(var $i=0;$i<$1;$i++)
	{
		var wo_list = new sforce.SObject("SVMXC__Service_Order__c");
		wo_list.SVMXC__Order_Type__c = $work_Orders_Xl[$i][0];
		wo_list.SVMXC__Order_Status__c = $work_Orders_Xl[$i][1];
		wo_list.SVMXC__Street__c = $work_Orders_Xl[$i][2];
		wo_list.SVMXC__City__c = $work_Orders_Xl[$i][3];
		wo_list.SVMXC__Zip__c = $work_Orders_Xl[$i][4];
		wo_list.SVMXC__Country__c = $work_Orders_Xl[$i][5];
		wo_list.SVMXC__Primary_Territory__c = $work_Orders_Xl[$i][6];
		wo_list.SVMXC__SM_Scheduling_Options__c = $work_Orders_Xl[$i][7];
		wo_list.SVMXC__Apply_Business_Hours_For_OptiMax__c = $work_Orders_Xl[$i][8];
		wo_list.SVMXC__Preferred_Business_Hours__c = $work_Orders_Xl[$i][9];
		wo_list.SVMXC__Service_Duration__c = $work_Orders_Xl[$i][10];
		CreateRecords.push(wo_list);
	}
	var wo_crt_result = _call(sforce.connection.create(CreateRecords));
	_log("wo_crt_result = "+wo_crt_result.length);
	
	
		$excel.writeToExcel("insertAtIndex", "../optimax/op_excleData/automation.xlsx", "BusinessHours", wo_crt_result[0].id, 17);
	
	
}

//</browser>