/**
 * This Test-cases verified the multiple calculation method for Repeat visit
 * when Top-level tracker is Case Owner : Meghana
 * 
 */


	var $un = "meghana.rao@servicemax.com";
	var $pwd = "salesforce100";
	var $url = "https://test.salesforce.com";
	var $data = _readExcelFile(
			"../../analytics/an_excleData/an_Datasheet1.xlsx", "Sheet1", true);
	var $insert_case = $data[1]["InsertCase"];
	var $Account = $data[1]["Account"];
	var $Technician = $data[1]["Technician"];
	var $Product = $data[1]["Product"];
	var $OrderStatus = $data[1]["OrderStatus"];
	var $Closedon = $data[1]["ClosedOn"];
	var $Site = $data[1]["Site"];
	var $Component = $data[1]["Component"];
	$bo_act_login.login($url, $un, $pwd);

	this.$WO_new_1;
	this.$WO_new_2;
	this.$Case;
	var $createcase = $op_act_sForceApiCall.sForceQuery($un, $pwd,
			$insert_case, "create");

	for (var $i = 0; $i < 300; $i++) {

		if (JSON.stringify($createcase) != null) {
			break;

		} else {
			_wait(5000);
		}

	}
	_log($createcase);
	var $query_case = "Select Id from Case Order by CreatedDate DESC Limit 1";

	var $fetchcasequery = $op_act_sForceApiCall.sForceQuery($un, $pwd,
			$query_case, "query");

	for (var $i = 0; $i < 300; $i++) {

		if (JSON.stringify($fetchcasequery) != null) {
			break;

		} else {
			_wait(5000);
		}

	}

	var casedummy;
	$fetchcasequery.forEach(function($casedummy) {
		$Case = $casedummy.Id;

	});

	var $insert_wo_first = "SVMXC__Service_Order__c  WO = new SVMXC__Service_Order__c (SVMXC__Company__c ='"
			+ $Account
			+ "', SVMXC__Product__c = '"
			+ $Product
			+ "' , SVMXC__Group_Member__c = '"
			+ $Technician
			+ "' ,SVMXC__Component__c = '"
			+ $Component
			+ "',SVMXC__Order_Status__c = '"
			+ $OrderStatus
			+ "' , SVMXC__Closed_On__c = "
			+ $Closedon
			+ ", SVMXC__Case__c = '"
			+ $Case
			+ "',SVMXC__Country__c = 'United States', SVMXC__Sub_Status__c = 'Resolved', SVMXC__Priority__c = 'High', SVMXC__Site__c = '"
			+ $Site + "');insert WO;";
	var $query_wo_first = "Select Name , Id  , SVMXC__Company__c , SVMXC__Component__c , SVMXC__Closed_On__c from SVMXC__Service_Order__c Order by CreatedDate DESC Limit 1";
	var $fetchwoquery = $op_act_sForceApiCall.sForceQuery($un, $pwd,
			$insert_wo_first, "create");

	for (var $i = 0; $i < 300; $i++) {

		if (JSON.stringify($fetchwoquery) != null) {
			break;

		} else {
			_wait(5000);
		}

	}

	var $store_first_wo = $op_act_sForceApiCall.sForceQuery($un, $pwd,
			$query_wo_first, "query");

	for (var $i = 0; $i < 300; $i++) {

		if (JSON.stringify($store_first_wo) != null) {
			break;

		} else {
			_wait(5000);
		}

	}

	$store_first_wo.forEach(function($wo1) {

		$WO_new_1 = $wo1.Id;

	});
	_log($WO_new_1);

	var $insert_wo_second = "SVMXC__Service_Order__c  WO = new SVMXC__Service_Order__c (SVMXC__Company__c ='"
			+ $Account
			+ "', SVMXC__Product__c = '"
			+ $Product
			+ "' , SVMXC__Group_Member__c = '"
			+ $Technician
			+ "' ,SVMXC__Component__c = '"
			+ $Component
			+ "', SVMXC__Order_Status__c = '"
			+ $OrderStatus
			+ "' , SVMXC__Closed_On__c = "
			+ $Closedon
			+ ", SVMXC__Case__c = '"
			+ $Case
			+ "',SVMXC__Country__c = 'United Kingdom', SVMXC__Sub_Status__c = 'Resolved', SVMXC__Priority__c = 'High', SVMXC__Site__c = '"
			+ $Site + "' );insert WO;";
	var $query_wo_second = "Select Name , Id  , SVMXC__Company__c , SVMXC__Component__c , SVMXC__Closed_On__c from SVMXC__Service_Order__c Order by CreatedDate DESC Limit 1";
	var $fetchwo2query = $op_act_sForceApiCall.sForceQuery($un, $pwd,
			$insert_wo_second, "create");

	for (var $i = 0; $i < 300; $i++) {

		if (JSON.stringify($fetchwo2query) != null) {
			break;

		} else {
			_wait(5000);
		}

	}

	var $store_sec_wo = $op_act_sForceApiCall.sForceQuery($un, $pwd,
			$query_wo_second, "query");

	for (var $i = 0; $i < 500; $i++) {

		if (JSON.stringify($store_sec_wo) != null) {
			break;

		} else {
			_wait(5000);
		}

	}

	$store_sec_wo.forEach(function($wo2) {

		$WO_new_2 = $wo2.Id;

	});
	_log($WO_new_2);