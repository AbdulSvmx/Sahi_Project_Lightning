
/*
 * Owner : Meghana Rao
 * This code is to push the data from Salesforce REST API calls from back end in Lightning
 */

$bo_act_login.login($g_url, "meghana.rao@servicemax.com", "cloud_103");


     var $username = "meghana.rao@servicemax.com";
     var $password = "cloud_103";
     var $clientId = "3MVG9zZht._ZaMulZsbNptzpIDmNd6xyt0zAOuNU_dtpTTg4DHSn9UmdBySUZS3_VOGeiWttaj3moLMuLIrje";
     var $consumerSecret = "1938983484606764552";
     //Authorization endpoint
     var $authEndPoint = "https://test.salesforce.com/services/oauth2/token";
     //response_type must be set to token
     var $responseType = "token";
     //This is the callback URL from the connected app
     var $redirectURI = "https://cs21.lightning.force.com";
     //Construct the URL with the required parameters
     var $requestURL = ""+$authEndPoint+"?grant_type=password&client_id="+$clientId+"&client_secret="+$consumerSecret+"&username="+$username+"&password="+$password+"&response_type="+$responseType+"&redirect_uri="+$redirectURI+"";
  
     	_log($requestURL);
$request = new RESTRequest();

 $request.setURL($requestURL);

	$response = $request.submit("post");

	var $AuthCode = $response.getBodyAsString(); //returns the content of the body using UTF-8 encoding
	var $AuthCode2 = $response.getBodyAsString("ISO-8859-1"); //returns the content of the body using ISO-8859-1 encoding
	_log($AuthCode);

	var $access_token = JSON.parse($AuthCode);
	
	_log($access_token['access_token']);
	
// Sample execution of Delete operation
	
// First lets get the ID from the Account value we need
	
	
	//var $accountname = "Acc462018101230";
	var $query = "Select+Id+from+Account where Name='Acc462018101230'";
         
	$request1 = new RESTRequest();	
	$request1.setURL("https://cs21.salesforce.com/services/data/v20.0/query/?q=Select+Id+from+Account+where+Name='Acc462018101230'");
	$request1.setCredentials("meghana.rao@servicemax.com", "cloud_103");
	$request1.setHeader("Authorization", "OAuth "+$access_token+"");
	//$request1.setHeader("Content-Type", "application/json");
	$response1 = $request1.submit("GET");

var $AuthCode_data = $response1.getBodyAsString(); //returns the content of the body using UTF-8 encoding
var $AuthCode_data2 = $response1.getBodyAsString("ISO-8859-1");
_log($AuthCode_data);
var $AccountId = JSON.parse($AuthCode_data);
_log($AccountId['Id']);

