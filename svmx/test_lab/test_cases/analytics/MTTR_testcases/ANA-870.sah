var $an_mttr_870 = _testcase("ANA-1023","Work Order as Top level Object");
$an_mttr_870.start();
var $un = "meghana.rao@servicemax.com";
var $pwd = "salesforce100";
var $url = "https://test.salesforce.com";
var $data = _readExcelFile("../../analytics/an_excleData/an_Datasheet1.xlsx","Sheet1",true);
var $Account2 = $data[2]["Account"];
var $Technician = $data[2]["Technician"];
var $Product = $data[2]["Product"];
var $OrderStatus = $data[1]["OrderStatus"];
var $Closedon = $data[1]["ClosedOn"];
var $Site = $data[1]["Site"];
var $Component = $data[2]["Component"];
$bo_act_login.login($url, $un, $pwd);

var $ana_870_insert_WO = "SVMXC__Service_Order__c  WO = new SVMXC__Service_Order__c ( Custom_Account__c ='"+ $Account2 +"', SVMXC__Product__c = '"+$Product+"' , SVMXC__Group_Member__c = '"+$Technician+"' ,SVMXC__Component__c = '"+$Component+"',SVMXC__Order_Status__c = '"+$OrderStatus+"' , SVMXC__Closed_On__c = "+$Closedon+",SVMXC__Country__c = 'United States', SVMXC__Sub_Status__c = 'Resolved', SVMXC__Priority__c = 'High', SVMXC__Site__c = '"+$Site+"');insert WO;";
var $ana_870_query_wo = "Select Name , Id  ,Custom_Account__c , SVMXC__Component__c , SVMXC__Closed_On__c from SVMXC__Service_Order__c Order by CreatedDate DESC Limit 1";
var $ana_870_result = $op_act_sForceApiCall.sForceQuery($un, $pwd, $ana_870_insert_WO , "create");

var $ana_870_fetch = $op_act_sForceApiCall.sForceQuery($un, $pwd, $ana_870_query_wo,"query");
_wait(1000);
var $ana_870_WO1 ;
var $ana_870_WO_Account1;
var $ana_870_RV_WO1;
var $ana_870_Is_Repeat_visit1;
var $ana_870_sr1;
var $var3;
var $varRV1;
_wait(1000);
$ana_870_fetch.forEach(function($ana_870_var1) {
	
	$ana_870_WO1 = $ana_870_var1.Id;

});
_log($ana_870_WO1);

// To create a Work detail under the WO 

$TopLevelWO.an_toplevelwo();

$an_act_Repeat_Visit_SR.rv_runEngine("meghana.rao@servicemax.com");

_wait(30000);
_wait(1000);

var $an_1023_primarywo1;


var $ana_870_query_RV1 = "Select SVMXC__Work_Order__c ,SVMXC__Primary_Work_Order__c, SVMXC__Account__c, SVMXC__Configuration_Name__c ,SVMXC__Is_Repeat_Visit__c ,SVMXC__Service_Request__c from SVMXC__SPM_Repeat_Visit__c where SVMXC__Work_Order__c ='"+ $ana_870_WO1 +"'";
var $ana_870_resultRV1 = $op_act_sForceApiCall.sForceQuery($un, $pwd, $ana_870_query_RV1,"query");
_wait(1000);
$ana_870_resultRV1.forEach(function($varRV1) {
	
	$ana_870_WO_Account1 = $varRV1.SVMXC__Account__c;
	$ana_870_Is_Repeat_visit1 = $varRV1.SVMXC__Is_Repeat_Visit__c;
	$ana_870_primarywo1 = $varRV1.SVMXC__Primary_Work_Order__c;
	
});

var $ana_870_WO_Account2;
var $ana_870_RV_sr2;
var $ana_870_Is_Repeat_visit2;
$an_mttr_870.end();

