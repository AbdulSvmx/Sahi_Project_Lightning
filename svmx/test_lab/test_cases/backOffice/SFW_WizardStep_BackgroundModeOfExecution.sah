
//author - Noor Salma Sharieff

var $SFW_WizardStep_BackgroundModeOfExecution = _testcase("$SFW_WizardStep_BackgroundModeOfExecution","This scenario is to verify the wizard step's background mode of execution.");
$SFW_WizardStep_BackgroundModeOfExecution.start();
_setSpeed(100);

var $wizardTitleName = $bo_act_common.generateRandomName("SFWTitle");
var $wizardIDName = $bo_act_common.generateRandomName("SFWId");
//var $wizardStep1Name = $bo_act_common.generateRandomName("SFWStep");

//Pre - Condition 
$bo_act_login.login($g_url, $bac_un, $bac_pwd);
var $accName = $bo_act_accounts.createAccount();
var $proName = $bo_act_products.createProduct("pro12", "--None--");
var $installedProduct = $bo_act_installedProduct.createInstalledProduct($proName,$accName,"");
var $contactName = $bo_act_contacts.createContact($accName);
var $caseNum = $bo_act_Cases.createCase("New", "High", "Email");
var $WONum  = $bo_act_workOrders.createWorkOrder($caseNum, $accName, $contactName, $installedProduct, "Open", "High", "Field Service");


var $wizardTitleName = $bo_act_common.generateRandomName("SFWTitle");
var $wizardIDName = $bo_act_common.generateRandomName("SFWId");

$bo_act_navigation.navigateToSfmWizard();
$bo_act_SFW.createWizardGeneralInfo("Work Order", $wizardTitleName, $wizardIDName);
$bo_act_SFW.createWizardStep("SFM", "Close Work Order", "Background");
$bo_act_SFW.quickSaveSFWizard();

$bo_act_navigation.navigateToWorkOrdersTab();
$bo_act_sfmVerifyWorkOrder.clickSpecificWorkOrder($WONum);
_selectDomain("/svmx/");
_assertExists(_button("/Close Work Order/",_near(_cell($wizardTitleName))));
_click(_button("/Close Work Order/",_near(_cell($wizardTitleName))));
_selectDomain();
_wait(5000);
_assertEqual("Closed",_getText(_div(0,_rightOf(_span("/Order Status/")))),"Work Order is not closed");


//Clean up function

var $datacreated = [$accName,$proName,$installedProduct,$caseNum,$WONum];
for (var i = 0; i < $datacreated.length; i++) {
	$bo_act_common.cleanUpfunction($datacreated[i]);
}
$bo_act_SFW.deleteWizards("Work Order", $wizardIDName);


$SFW_WizardStep_BackgroundModeOfExecution.end();



