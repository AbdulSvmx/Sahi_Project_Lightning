var $rs_6940 = _testcase("RS_6940","Verify Lookup auto resolve with override context in Child line");
$rs_6940.start();
//rs_7015_2382018153159
//rs_7015_2382018134418
		// Login to App
/*		$bo_act_login.login($g_url,$sfmUsn,$sfmPwd);

		//clone standard SFM
		var $sfmNameToBeCloned="Manage Work Order Lines - Usage";
		var $sfmName=$bo_act_common.generateRandomName("rs_6940_");
		var $sfmTemplateSaveAsName=$bo_act_common.generateRandomName("SFM_Page_");
		var $sfmTemplate="SVMXSTD: Manage WO Usage Lines";
		var $fieldName=["Account","AutoContact"];
		var $containerName=["Parts","Parts"];
		$sfm_act_SFM.cloneTDM016($sfmNameToBeCloned, $sfmName, false, $sfmTemplateSaveAsName, $sfmTemplate, $fieldName, $containerName);
		
		//Context lookup setting up
		_click(_f("main").s_richtext($fieldName[1]).near(_f("main").s_richtext("Parts")));
		_setSelected(_f("main").s_combobox("/ComboBox/").rightOf(_f("main").uiftetextfield("Context Source")),"Parts");
		_click(_f("main").s_checkbox("Override Context"));
		_setSelected(_f("main").s_combobox("/ComboBox/").rightOf(_f("main").uiftetextfield("Context")),"Account");
		_setSelected(_f("main").s_combobox("/ComboBox/").rightOf(_f("main").uiftetextfield("Matching Field")),"Account ID");
		
		//Save SFM after adding context lookup
		_setStrictVisibilityCheck(true);
		_click($bo_pg_sfmTransactionAndDesigner.btn_pageLayoutSave);
		_wait(5000,_isVisible($bo_pg_sfmTransactionAndDesigner.btn_sfmpageSaveConfirmMsg));
		_click($bo_pg_sfmTransactionAndDesigner.btn_saveAndclose);
		_setStrictVisibilityCheck(false);
		
		//add sfm to wizard
		var $wizardObject="Work Order";
		var $wizardName1 =$wizardName[3];
		var $wizardType="SFM";
		var $profile="";
		var $handOver=false;
		_log("Wizard Name: "+$wizardName1);
		$sfm_act_wizards.addToWizard($wizardObject, $wizardName1, $wizardType, $sfmName, $handOver, $profile); 
*/			
		//Create Account
		var $Account=new Array();
		$Account[0]=$bo_act_common.generateRandomName("GlobalInc_AccountRS_6940_");
		$Account[1]=$bo_act_common.generateRandomName("GlobalMedia_AccountRS_6940_");
		$AccountID=new Array();
		for (var $i = 0; $i < $Account.length; $i++) {
			$objName= "Account";
			$obJson = "{\"Name\":\""+$Account[$i]+"\"}";
			//create Account
			$filterValue=$sfm_act_restApiMethods.postRestApi($objName,$obJson,"POST");
			$AccountID[$i]=$filterValue;
		}
		
		$contactNameList = ["Leanne Tomlin","Howard Jones","Jason Smith","Jason David","Jon Amos","Howard White","Geoff Minor"];
		//Create Users
		var $lastName;
		var $userName=new Array();
		for (var $i = 0; $i <=6; $i++) {
			$objName= "Contact";
			if ($i<4) {
				$lastName=$bo_act_common.generateRandomName($contactNameList[$i]+"_");
				$obJson="{\"LastName\":\""+$lastName+"\",\"AccountId\":\""+$AccountID[0]+"\"}";
			}else {
				$lastName=$bo_act_common.generateRandomName($contactNameList[$i]+"_");
				//_log("user: "+$lastName);
				$obJson="{\"LastName\":\""+$lastName+"\",\"AccountId\":\""+$AccountID[1]+"\"}";
			}
			//create Account
			$filterValue=$sfm_act_restApiMethods.postRestApi($objName,$obJson,"POST");
			$userName[$i]=$lastName;
		}
		
		//WO creation
		$objName= "SVMXC__Service_Order__c";
		$obJson = "{\"SVMXC__Order_Status__c\":\"Open\",\"SVMXC__Order_Type__c\":\"Field Service\"}";
		$columnName = "Name";
		$filter="id";
		$filterValue=$sfm_act_restApiMethods.postRestApi($objName,$obJson,"POST");
		//get the caseNumber
		$WONumber =$sfm_act_restApiMethods.getRestApi("GET", $objName, $columnName, $filter, $filterValue);
		_log("WO number: "+$WONumber);
		
		//Create Product
		$objName= "Products";
		$productName=$bo_act_common.generateRandomName("Pro_RS_6940_");
		$obJson = "{\"Product Name\":\""+$productName+"\"}";
		$filterValue=$sfm_act_restApiMethods.postRestApi($objName,$obJson,"POST");

		
		$sfm_act_common.globalSearchInLightning($WONumber);
		_setStrictVisibilityCheck(true);
		$sfm_act_createCustomWizard.clickWizardBtn($sfmName);
		_wait(5000,_isVisible(_div("/"+$sfmName+"/")));
		
		_click(_span("+ Add Parts"));
		_setValue(_textbox("/sfm-text/",_near(_span("Search"))), $productName);
		_click(_span("Search"));
		_click(_span("/checkcolumn/",_leftOf(_div("RA_Pro1632018205842"))));
		_click(_link("Add"));
		//$sfm_act_sfmDesigner.addChildLine("Parts"); 
		
		//Assert "No matching record" DVR
		_click(_div("/grid-cell/",_under(_parentNode(_span("Account"),"DIV",4))));
		_wait(1000);
		_setValue(_textbox("/inputEl/",_in(_div("/sfm-lookupcelleditor/"))),$Account[0]+"   ");
		_click(_link("Quick Save"));
		_wait(1000);
		_assertExists(_div("Account: No matching record(s) found for this keyword: Account _"));
		_wait(1000);
		
		//assert Multiple item found DVR
		_click(_div("/grid-cell/",_under(_parentNode(_span("Account"),"DIV",4))));
		_wait(1000);
		_setValue(_textbox("/inputEl/",_in(_div("/sfm-lookupcelleditor/"))),"AccountRS_6940_");
		_click(_link("Quick Save"));
		_wait(1000);
		_assertExists(_div("Account: Multiple items found. Click lookup icon to refine search."));
		_wait(1000);
		
		//Select from search
		_click(_link("AutoContact",_in(_div("Account: Multiple items found. Click lookup icon to refine search."))));
		_wait(1000);		
		_click(_div("/trigger-search/",_in(_div("/sfm-lookupcelleditor/"))));
		_wait(5000,_isVisible(_div("/Recent Items:/")));
		_setValue(_textbox("/sfm-text/",_near(_span("Search"))),$Account[0]);
		_click(_span("Search"));
		_wait(5000,_isVisible(_link($Account[0])));
		_click(_link($Account[0]));
		_wait(3000);
		
		
		//assert Multiple item found DVR on AutoContact Field
		_click(_div("/grid-cell/",_under(_parentNode(_span("AutoContact"),"DIV",4))));
		_wait(1000);
		_setValue(_textbox("/inputEl/",_in(_div("/sfm-lookupcelleditor/"))),"Jason");
		_click(_link("Quick Save"));
		_wait(1000);
		_assertExists(_div("AutoContact: Multiple items found. Click lookup icon to refine search."));
		_wait(1000);
		
		
		
		//Select from search
		_click(_link("AutoContact",_in(_div("AutoContact: Multiple items found. Click lookup icon to refine search."))));
		_wait(1000);		
		_click(_div("/trigger-search/",_in(_div("/sfm-lookupcelleditor/"))));
		_wait(5000,_isVisible(_div("/Recent Items:/")));
		_click(_span("Search"));
		_wait(5000,_isVisible(_link($userName[2])));
		_assertExist(_link($userName[2]));
		_assertExist(_link($userName[3]));
		_click(_link($userName[2]));
		_wait(3000);
		
		if (_exists(_div("Price not calculated, because entitlement check has not been performed."))) {
			_click(_span("Ok"));
		}
		_assertExist();

		
		
		

/*		
		var $users=["Leanne Tomlin","Howard Jones","Jason Smith","Jason David","Jon Amos","Howard White","Geoff Minor"];
		
		
		
		
		
		Account 1: Global Inc
		Contact (Associate below contacts to the Global Inc account):
		Leanne Tomlin,
		Howard Jones,
		Jason Smith
		Jason David


		Account 2: Global Media
		Contact (Associate below contacts to the Global Media account):
		Jon Amos,
		Howard White,
		Geoff Minor 
		

		
		
		
		
		
		
		

$wizTitle = $bo_act_common.generateRandomName("SFM Wiz");
$sfmName = $bo_act_common.generateRandomName("SFM_Auto_");
//$sfmName = "SFM_Auto_13122017133636";
$sfmPgLayoutName =	$bo_act_common.generateRandomName("SFM_Auto_Page");
$processName = "Manage Work Order Lines - Usage";
$containerName = ["Parts","Parts"];
$fieldName = ["Account","AutoContact"];
$sfmtemplate = "SVMXSTD: Manage WO Usage Lines";
$accountName = ["Auto Global Inc","Auto Global Media"];
$contactName1 = ["Leanne Tomlin","Howard Jones","Jason Smith","Jason David"];
$contactName2 = ["Jon Amos","Howard White","Geoff Minor"];
$bo_act_login.login($g_url,$sfmUsn,$sfmPwd);
//$sfm_act_addDeleteMeth.createAccount($accountName);
$sfm_act_addDeleteMeth.verifyAndCreateAccount("My Accounts","Auto Global Inc");
$sfm_act_addDeleteMeth.verifyAndCreateAccount("My Accounts","Auto Global Media");
$sfm_act_addDeleteMeth.createContact($accountName[0], $contactName1);
$sfm_act_addDeleteMeth.createContact($accountName[1], $contactName2);
//$bo_act_navigation.navigateToSfmTransactionDesigner();
$sfm_act_SFM.cloneTDM016($processName, $sfmName, false, $sfmPgLayoutName,$sfmtemplate, $fieldName, $containerName);
_click($bo_pg_sfmTransactionAndDesigner.btn_finalQuickSave);
//_wait(30000);
$bo_act_navigation.navigateToSfmWizard();
$sfm_act_createCustomWizard.chooseObject("Work Order");
$sfm_act_createCustomWizard.addManageWizSteps($wizTitle,"SFM",$sfmName);
$woName=$sfm_act_createCustomWizard.createBlankWo();
_log($woName);
$sfm_act_createCustomWizard.clickWizardBtn($sfmName);
_selectDomain();
_setStrictVisibilityCheck(true);
_click($sfm_pg_wizardWindow.btn_addRow);
_click($sfm_pg_wizardWindow.btn_edit);
_setValue($sfm_pg_wizardWindow.txt_part,"Safari");
$sfm_act_createCustomWizard.validateErrorMessage("Globe", "No matching record",true);
_click($sfm_pg_wizardWindow.btn_edit);
$sfm_act_createCustomWizard.validateExactMatch("Auto Global Inc",true);
_click($sfm_pg_wizardWindow.btn_recentItemsCancel);
_click($sfm_pg_wizardWindow.btn_update);
_click($sfm_pg_wizardWindow.btn_edit);
$sfm_act_createCustomWizard.validateErrorMessage("Global", "Multiple items found",true);
$sfm_act_createCustomWizard.validatePartialMatch();
//$sfm_act_addDeleteMeth.deleteAccount($accountName);
*/
$rs_6940.end();